@startuml
title Процесс оплаты с начислением баллов

start
:Клиент совершает покупку;
:Процессинг подтверждает транзакцию;
if (Loyalty Engine доступен?) then (Да)
  :Рассчитать баллы;
  :Начислить баллы клиенту;
  :Отправить push-уведомление;
else (Нет)
  :Сохранить транзакцию в очередь;
  :Сообщить клиенту об ожидании;
endif
:Обновить баланс и историю в приложении;
stop
@enduml
